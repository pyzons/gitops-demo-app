apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
  namespace: monitoring
data:
  kubernetes-cluster-dashboard.json: |
    {
      "id": null,
      "uid": "kubernetes-cluster",
      "title": "Kubernetes Cluster Overview",
      "tags": ["kubernetes", "cluster"],
      "style": "dark",
      "timezone": "browser",
      "editable": true,
      "graphTooltip": 1,
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "refresh": "30s",
      "panels": [
        {
          "id": 1,
          "title": "Cluster Nodes",
          "type": "stat",
          "targets": [
            {
              "expr": "sum(up{job=\"kubernetes-nodes\"})",
              "legendFormat": "Total Nodes",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "thresholds"},
              "thresholds": {
                "steps": [
                  {"color": "red", "value": null},
                  {"color": "green", "value": 1}
                ]
              },
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0}
        },
        {
          "id": 2,
          "title": "Running Pods",
          "type": "stat",
          "targets": [
            {
              "expr": "sum(kube_pod_status_phase{phase=\"Running\"})",
              "legendFormat": "Running Pods",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "thresholds"},
              "thresholds": {
                "steps": [
                  {"color": "red", "value": null},
                  {"color": "green", "value": 1}
                ]
              },
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0}
        },
        {
          "id": 3,
          "title": "CPU Usage",
          "type": "stat",
          "targets": [
            {
              "expr": "100 - (avg(irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
              "legendFormat": "CPU Usage %",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "thresholds"},
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 70},
                  {"color": "red", "value": 90}
                ]
              },
              "unit": "percent"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0}
        },
        {
          "id": 4,
          "title": "Memory Usage",
          "type": "stat",
          "targets": [
            {
              "expr": "100 * (1 - ((node_memory_MemAvailable_bytes) / (node_memory_MemTotal_bytes)))",
              "legendFormat": "Memory Usage %",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "thresholds"},
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 70},
                  {"color": "red", "value": 90}
                ]
              },
              "unit": "percent"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0}
        },
        {
          "id": 5,
          "title": "CPU Usage by Node",
          "type": "timeseries",
          "targets": [
            {
              "expr": "100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
              "legendFormat": "{{instance}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "min": 0,
              "max": 100,
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 70},
                  {"color": "red", "value": 90}
                ]
              }
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4}
        },
        {
          "id": 6,
          "title": "Memory Usage by Node",
          "type": "timeseries",
          "targets": [
            {
              "expr": "100 * (1 - ((node_memory_MemAvailable_bytes) / (node_memory_MemTotal_bytes)))",
              "legendFormat": "{{instance}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "min": 0,
              "max": 100,
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 70},
                  {"color": "red", "value": 90}
                ]
              }
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4}
        },
        {
          "id": 7,
          "title": "Pods by Namespace",
          "type": "piechart",
          "targets": [
            {
              "expr": "sum by (namespace) (kube_pod_info)",
              "legendFormat": "{{namespace}}",
              "refId": "A"
            }
          ],
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right"
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 12}
        },
        {
          "id": 8,
          "title": "Network Traffic",
          "type": "timeseries",
          "targets": [
            {
              "expr": "irate(node_network_receive_bytes_total{device!=\"lo\"}[5m])",
              "legendFormat": "{{device}} - Receive",
              "refId": "A"
            },
            {
              "expr": "irate(node_network_transmit_bytes_total{device!=\"lo\"}[5m])",
              "legendFormat": "{{device}} - Transmit",
              "refId": "B"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "Bps",
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 1000000},
                  {"color": "red", "value": 10000000}
                ]
              }
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 12}
        },
        {
          "id": 9,
          "title": "Disk Usage",
          "type": "timeseries",
          "targets": [
            {
              "expr": "100 - ((node_filesystem_avail_bytes{mountpoint=\"/\"} * 100) / node_filesystem_size_bytes{mountpoint=\"/\"})",
              "legendFormat": "{{instance}} - Root",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "min": 0,
              "max": 100,
              "thresholds": {
                "steps": [
                  {"color": "green", "value": null},
                  {"color": "orange", "value": 80},
                  {"color": "red", "value": 90}
                ]
              }
            }
          },
          "gridPos": {"h": 8, "w": 24, "x": 0, "y": 20}
        }
      ]
    }

  node-exporter-dashboard.json: |
    {
      "id": null,
      "uid": "node-exporter",
      "title": "Node Exporter Metrics",
      "tags": ["node-exporter", "system"],
      "style": "dark",
      "timezone": "browser",
      "editable": true,
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "refresh": "30s",
      "panels": [
        {
          "id": 1,
          "title": "CPU Cores",
          "type": "stat",
          "targets": [
            {
              "expr": "count(count by (cpu)(node_cpu_seconds_total{mode=\"idle\"}))",
              "legendFormat": "CPU Cores",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0}
        },
        {
          "id": 2,
          "title": "Total Memory",
          "type": "stat",
          "targets": [
            {
              "expr": "node_memory_MemTotal_bytes",
              "legendFormat": "Total Memory",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "bytes"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0}
        },
        {
          "id": 3,
          "title": "Load Average 1m",
          "type": "timeseries",
          "targets": [
            {
              "expr": "node_load1",
              "legendFormat": "{{instance}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4}
        },
        {
          "id": 4,
          "title": "Disk I/O",
          "type": "timeseries",
          "targets": [
            {
              "expr": "irate(node_disk_read_bytes_total[5m])",
              "legendFormat": "{{device}} - Read",
              "refId": "A"
            },
            {
              "expr": "irate(node_disk_written_bytes_total[5m])",
              "legendFormat": "{{device}} - Write",
              "refId": "B"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "Bps"
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4}
        }
      ]
    }

  argocd-dashboard.json: |
    {
      "id": null,
      "uid": "argocd-gitops",
      "title": "ArgoCD GitOps Dashboard",
      "tags": ["argocd", "gitops"],
      "style": "dark",
      "timezone": "browser",
      "editable": true,
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "refresh": "30s",
      "panels": [
        {
          "id": 1,
          "title": "Application Status",
          "type": "stat",
          "targets": [
            {
              "expr": "sum(argocd_app_info)",
              "legendFormat": "Total Applications",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0}
        },
        {
          "id": 2,
          "title": "Sync Status",
          "type": "piechart",
          "targets": [
            {
              "expr": "sum by (sync_status) (argocd_app_info)",
              "legendFormat": "{{sync_status}}",
              "refId": "A"
            }
          ],
          "gridPos": {"h": 8, "w": 12, "x": 6, "y": 0}
        },
        {
          "id": 3,
          "title": "Health Status",
          "type": "piechart",
          "targets": [
            {
              "expr": "sum by (health_status) (argocd_app_info)",
              "legendFormat": "{{health_status}}",
              "refId": "A"
            }
          ],
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8}
        }
      ]
    }

  prometheus-dashboard.json: |
    {
      "id": null,
      "uid": "prometheus-monitoring",
      "title": "Prometheus Monitoring",
      "tags": ["prometheus", "monitoring"],
      "style": "dark",
      "timezone": "browser",
      "editable": true,
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "refresh": "30s",
      "panels": [
        {
          "id": 1,
          "title": "Prometheus Targets",
          "type": "stat",
          "targets": [
            {
              "expr": "prometheus_sd_discovered_targets",
              "legendFormat": "Discovered Targets",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0}
        },
        {
          "id": 2,
          "title": "Prometheus Config Reload",
          "type": "stat",
          "targets": [
            {
              "expr": "prometheus_config_last_reload_successful",
              "legendFormat": "Config Reload Success",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0}
        },
        {
          "id": 3,
          "title": "Query Duration",
          "type": "timeseries",
          "targets": [
            {
              "expr": "prometheus_engine_query_duration_seconds",
              "legendFormat": "{{quantile}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "s"
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4}
        },
        {
          "id": 4,
          "title": "Samples Ingested",
          "type": "timeseries",
          "targets": [
            {
              "expr": "rate(prometheus_tsdb_samples_appended_total[5m])",
              "legendFormat": "Samples/sec",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short"
            }
          },
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4}
        }
      ]
    }
